\documentclass[notitlepage,aps,prd,nofootinbib]{revtex4-1}

\usepackage{subfig}
%\usepackage[colorinlistoftodos]{todonotes}
\usepackage{float}

%\usepackage[protrusion=true,expansion=true]{microtype}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{bbm}
\usepackage{ulem}
%\usepackage{feynmp-auto}
%\usepackage{slashed}
%\usepackage[absolute,overlay]{textpos}
\usepackage[usenames, dvipsnames]{color}
\usepackage{graphicx}
\usepackage{listings}
\usepackage{epsfig}
\usepackage{hyperref}
%\usepackage{tikz}
\usepackage{enumerate}
%\usepackage{fixltx2e} % buggy
\usepackage[compatibility=false]{caption}
%\usepackage{subcaption} % doesn't work with subfigure
\usepackage{pdfpages}
%\usepackage{setspace}
\usepackage{verbatim}
\usepackage{physics}

% Turn off meaningless float warnings
\usepackage{silence}
\WarningFilter{revtex4-1}{Repair the float}

\DeclareRobustCommand{\orderof}{\ensuremath{\mathcal{O}}}

\definecolor{dukeblue}{RGB}{0,0,156}
\definecolor{dukedarkblue}{RGB}{0,26,87}
\definecolor{dukeblack}{RGB}{79,79,79}
\definecolor{dukegray}{RGB}{79,79,79}
\definecolor{dukesecbrown}{RGB}{217,200,158}
\definecolor{dukesecblue}{RGB}{127,169,174}

%\renewcommand*{\thefootnote}{\fnsymbol{footnote}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\hypersetup{
    breaklinks,
    baseurl       = http://,
    pdfborder     = 0 0 0,
    pdfpagemode   = UseNone,% do not show thumbnails or bookmarks on opening
    pdfstartpage  = 1,
    bookmarksopen = true,
    bookmarksdepth= 2,% to show sections and subsections
% revtex needs author and title declared after \begin{document}, so have to hard code them...
%    pdfauthor     = {\@author},
%    pdftitle      = {\@title},
    pdfauthor     = {Yuanyuan Xu, Matthew Epland, Xiaqing Li, Wesley Cohen},
    pdftitle      = {Phys 566 Group Project 1},
    pdfsubject    = {},
    pdfkeywords   = {}}


% Code import settings
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\definecolor{mygreen}{rgb}{0,0.6,0}
\definecolor{mygray}{rgb}{0.5,0.5,0.5}
\definecolor{mymauve}{rgb}{0.58,0,0.82}

%\lstset{ %
\lstdefinestyle{python}{ %
  backgroundcolor=\color{white},   % choose the background color; you must add \usepackage{color} or \usepackage{xcolor}
  basicstyle=\scriptsize,          % the size of the fonts that are used for the code
  breakatwhitespace=false,         % sets if automatic breaks should only happen at whitespace
  breaklines=true,                 % sets automatic line breaking
  captionpos=b,                    % sets the caption-position to bottom
  commentstyle=\color{mygreen},    % comment style
  deletekeywords={...},            % if you want to delete keywords from the given language
  escapeinside={\%*}{*)},          % if you want to add LaTeX within your code
  extendedchars=true,              % lets you use non-ASCII characters; for 8-bits encodings only, does not work with UTF-8
  frame=single,	                   % adds a frame around the code
  keepspaces=true,                 % keeps spaces in text, useful for keeping indentation of code (possibly needs columns=flexible)
  keywordstyle=\color{blue},       % keyword style
  language=Python,                 % the language of the code
  otherkeywords={*,...},           % if you want to add more keywords to the set
  numbers=left,                    % where to put the line-numbers; possible values are (none, left, right)
  numbersep=5pt,                   % how far the line-numbers are from the code
  numberstyle=\tiny\color{mygray}, % the style that is used for the line-numbers
  rulecolor=\color{black},         % if not set, the frame-color may be changed on line-breaks within not-black text (e.g. comments (green here))
  showspaces=false,                % show spaces everywhere adding particular underscores; it overrides 'showstringspaces'
  showstringspaces=false,          % underline spaces within strings only
  showtabs=false,                  % show tabs within strings adding particular underscores
  stepnumber=5,                    % the step between two line-numbers. If it's 1, each line will be numbered
  stringstyle=\color{mymauve},     % string literal style
  tabsize=2,	                   % sets default tabsize to 2 spaces
%  title=\lstname                   % show the filename of files included with \lstinputlisting; also try caption instead of title
  title={\protect\filename@parse{\lstname}\protect\filename@base.\filename@ext},
  firstnumber=0,
%  linewidth=0.95\textwidth
  xleftmargin=0.01\textwidth,
  xrightmargin=0.01\textwidth
}

\lstdefinestyle{output}{ %
  backgroundcolor=\color{white},   % choose the background color; you must add \usepackage{color} or \usepackage{xcolor}
  basicstyle=\scriptsize,          % the size of the fonts that are used for the code
  breakatwhitespace=false,         % sets if automatic breaks should only happen at whitespace
  breaklines=true,                 % sets automatic line breaking
  captionpos=b,                    % sets the caption-position to bottom
  escapeinside={\%*}{*)},          % if you want to add LaTeX within your code
  frame=single,	                   % adds a frame around the code
  keepspaces=true,                 % keeps spaces in text, useful for keeping indentation of code (possibly needs columns=flexible)
  numbers=left,                    % where to put the line-numbers; possible values are (none, left, right)
  numbersep=5pt,                   % how far the line-numbers are from the code
  numberstyle=\tiny\color{mygray}, % the style that is used for the line-numbers
  rulecolor=\color{black},         % if not set, the frame-color may be changed on line-breaks within not-black text (e.g. comments (green here))
  stepnumber=5,                    % the step between two line-numbers. If it's 1, each line will be numbered
  tabsize=2,	                   % sets default tabsize to 2 spaces
%  title=\lstname                   % show the filename of files included with \lstinputlisting; also try caption instead of title
  title={\protect\filename@parse{\lstname}\protect\filename@base.\filename@ext},
  firstnumber=0,
%  linewidth=0.95\textwidth
  xleftmargin=0.01\textwidth,
  xrightmargin=0.01\textwidth
}

\newcommand{\degree}{\ensuremath{^{\circ}}}

% Select between raw and saved plots here TODO
\graphicspath{{../code/output/}}
%\graphicspath{{../code/output/plots_for_paper/}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{document}

\title{PHYS 566 Group Project 1}
\author{Yuanyuan Xu, Matthew Epland, Xiaqing Li, Wesley Cohen}
\affiliation{Duke University, Durham, NC 27707, USA}

\date{\today}

\begin{abstract}
TODO
\end{abstract}\maketitle

\section{Introduction}
\label{sec:intro}
TODO

\section{Theory}
\subsection{TODO}
\label{subsec:TODO}
TODO

\begin{align}
x &= y \label{eq:todo1} \\
y &= z \label{eq:todo2}
\end{align}
\label{sec:theory}
\subsection{Random Walk and Diffusion}
\label{sec:theory_2}
Suppose $P(i, j, k, n)$ is the probability to find the particle at $(x, y, z)$ at time $t$. If walker is on one of the 6 nearest neighbor sites of time $t = n - 1$, there is a probability of $\frac{1}{6}$ that it will move to $(i, j, k)$ at time n.
\begin{equation}
	P(i, j, k) = \frac{1}{6}[P(i, j, k, n-1) + P(i-1, j, k, n-1) + P(i, j+1, k, n-1) + P(i, j-1, k, n-1) + P(i, j, k+1, n-1) + P(i, j, k-1, n-1)].
\end{equation}
Rearranging this equation, we get
\begin{equation}
	\begin{split}
		P(i, j, k, n) - P(i, j, k, n-1) = \frac{1}{6}\lbrace &[P(i+1, j, k, n-1) - 2P(i, j, k, n-1) + P(i-1, j, k, n-1)]\\
		+ &[P(i, j+1, k, n-1) - 2P(i, j, k, n-1) + P(i, j-1, k, n-1)]\\
		+ &[P(i, j, k+1, n-1) - 2P(i, j, k, n-1) + P(i, j, k-1, n-1)]\rbrace.
	\end{split}
\end{equation}
Apart from factor $1/\Delta t$, the left side of this equation is just the finite difference approximation for the time derivative of $P$, while the right-hand side is proportional to a second order space derivative. This suggests taking the continuum limit, which leads to
\begin{equation} \label{eq:2_1}
	\frac{\partial P(x, y, z, t)}{\partial t} = D\nabla^{2}P(x,y,z,t),
\end{equation} 
where $D = (1/6)(\Delta x)^{2} / \Delta t$ in this approximation. Eqn.~\eqref{eq:2_1} is the diffusion equation, and our derivative shows the close connection between the random walks and diffusion. The density $\rho$ obeys the same equation
\begin{equation} \label{eq:2_2}
	\frac{\partial \rho}{\partial t} = D\nabla^{2}\rho.
\end{equation}

Converting Eqn.~\eqref{eq:2_2} to one dimension yields
\begin{equation}
	\frac{\partial\rho}{\partial t} = D\frac{\partial^{2}\rho}{\partial x^{2}},
\end{equation}
and the finite-difference version of this equation is 
\begin{equation}
	\frac{\rho(i, n+1) - \rho(i, n)}{\Delta t} = \frac{\rho(i+1, n) - 2\rho(i, n) + \rho(i-1, n)}{(\Delta x)^{2}}
\end{equation}
Rearranging to express the density at time step $n+1$ in terms of $\rho$ at step $n$ we find
\begin{equation} \label{eq:2_3}
	\rho(i, n+1) = \rho(i, n) + \frac{D\Delta t}{(\Delta x)^{2}}[\rho(i+1, n) - 2\rho(i, n) + \rho(i-1, n)]. 
\end{equation}

If we are given the initial distribution of the cream particles, $\rho(x, t=0)$, we can use Eqn.~\eqref{eq:2_3} to solve for $\rho$ at future times. General analytic solutions are hard to come by. One special case is 
\begin{equation}
	\rho(x, t) = \frac{1}{\sigma}e^{-\frac{x^{2}}{2\sigma^{2}}},
\end{equation}
where $\sigma$ is time-dependent, with $\sigma = \sqrt{2Dt}$. To guarantee numerical stability we must make sure that the space and time steps satisfy
\begin{equation}
	\Delta t \leq (\Delta x)^{2}/(2D).
\end{equation}

\clearpage
\section{Results}
\label{sec:results}
\subsection{2D Random Walk}
TODO
\newpage
\subsection{Diffusion Equation}
\label{subsec:results_2}
\subsubsection{Part a}
\label{subsubsec:results_2_a}
We derive the spatial expectation values $\expval{x^{2}(t)}$ as follows,
\begin{align}
	\expval{x^{2}(t)} &= \int_{-\infty}^{+\infty} \rho(x, t) x^{2} dx, \\
	\expval{x^{2}(t)} &= \frac{2}{\sqrt{2\pi\sigma^{2}(t)}} \int_{0}^{+\infty} x^{2} \exp(-\frac{x^{2}}{2\sigma^{2}(t)}).
\end{align}
Now we use the Gaussian integral that
\begin{equation}
	\int_{0}^{+\infty} x^{2n} \exp{-x^{2}/a^{2}} dx = \sqrt{\pi} \frac{(2n)!}{n!}\Big( \frac{a}{2} \Big)^{2n+1}.
\end{equation}
Let $n = 1$ and $a = \sqrt{2}\sigma(t)$, we can get
\begin{equation}
	\begin{split}
		\expval{x^{2}(t)} &= \frac{2}{\sqrt{2\pi\sigma^{2}(t)}} \cdot \sqrt{\pi}\cdot \frac{2!}{1!} \cdot \Big( \frac{\sqrt{2}\sigma(t)}{2} \Big)^{3} \\
		&= \sigma^{2}(t).
	\end{split} 
\end{equation}

\newpage
\subsubsection{Part b}
\label{subsubsec:results_2_b}
\begin{figure}[!htbc]
  \centering
  \includegraphics[width=.6\textwidth]{../output/plots_for_paper/problem_2/part_b.pdf}
  	{\par\nobreak\rule[9pt]{35em}{0.5pt}\vspace{-5mm}}
	\caption{Diffusion in one dimension}
	\label{fig:part_b}
\end{figure}

\begin{center}
	\begin{tabular}{ | p{2cm} | p{2cm} | p{2cm} | p{2cm} | p{2cm} |}
		\hline
		Steps & Time & $\sigma(t) = \sqrt{2Dt}$ & $\sigma_{\mathrm{fit}}(t)$ & Percent error\\
		\hline
		300  & 0.03 & 0.346410 & 0.362748 & 4.716236\%\\
		\hline
		600  & 0.60 & 0.489898 & 0.511874 & 4.485857\%\\ 
		\hline
		1200 & 1.20 & 0.692820 & 0.723106 & 4.371316\%\\
		\hline
		2400 & 2.40 & 0.979796 & 0.102207 & 4.314208\%\\
		\hline
		4800 & 4.80 & 0.138564 & 0.144493 & 4.278783\%\\
		\hline
	\end{tabular}
\end{center}
\newpage


\clearpage
\section{Conclusions}
\label{sec:Conclusions}
TODO

The Python source code used to produce these results can be found online at \url{http://github.com/mepland/PHYS_566_Computational_Group_Project_1}, and is included in Section~\ref{sec:code}.


\clearpage
\section{Supporting Material}
\label{sec:Supporting_Material}

% \lstinputlisting[style=output,label={lst:output}]{../code/output/output.log} % TODO insert the code's output


\clearpage
\includepdf[pages={1}]{../group_project1a.pdf}
\includepdf[pages={2}]{../group_project1a.pdf}

\clearpage
\section{Code}
\label{sec:code}

%\lstinputlisting[style=python]{../code/TODO.py} % TODO

\end{document} %%% end of doc %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\bibliographystyle{../bib_files/atlasBibStyleWoTitle}
\bibliography{../bib_files/my_bib.bib}

% Code to insert figures
\begin{figure}[!htbc]
  \centering
  \includegraphics[width=.6\textwidth]{part_a/TODO.pdf}
	{\par\nobreak\rule[9pt]{35em}{0.5pt}\vspace{-5mm}}
	\caption{TODO}
	\label{fig:TODO}
\end{figure}

